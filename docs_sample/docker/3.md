# docker容器的数据卷

### 3.1 数据卷概念

思考：

• Docker 容器删除后，在容器中产生的数据也会随之销毁 

• Docker 容器和外部机器可以直接交换文件吗？ 

• 容器之间想要进行数据交互？

**数据卷**

* 数据卷是宿主机中的一个目录或文件
* 当容器目录和数据卷目录绑定后，对方的修改会立即同步
* 一个数据卷可以被多个容器同时挂载
* 一个容器也可以被挂载多个数据卷

**数据卷的作用**

• 容器数据持久化 

• 外部机器和容器间接通信 

• 容器之间数据交换 

### 3.2 配置数据卷

**创建启动容器时，使用 –v 参数 设置数据卷**

~~~shell
docker run ... -v 宿主机目录(文件):容器内目录(文件) ...
~~~

**注意事项：** 

1. 目录必须是绝对路径 

2. 如果目录不存在，会自动创建 

3. 一个容器可以挂载多个数据卷
4. 一个数据卷也可以被多个容器挂载
5. 两个容器可以挂载同一个容器

在宿主机中实现与容器目录的挂载：

1. 数据卷的持久化：

​	当我们把c1容器删除后，宿主机中的数据卷依然存在。  所以当我们重新创建一个容器的同时依然可以挂载宿主机中的data文件夹，对应data里的数据依然同步到容器中。

2. 一个容器可以挂载多个数据卷

3. 多个容器可以挂载同一个数据卷

分别创建两个容器，两个容器都挂载宿主机中data目录，当 修改c3容器的data目录c4会实现同步。

从而实现两个容器之间的交互。

### 3.3 配置数据卷容器

**多容器进行数据交换** 

1. 多个容器挂载同一个数据卷 

2. 数据卷容器 

**步骤：**

1.创建启动c3数据卷容器，使用 –v 参数 设置数据卷

~~~shell
docker run –it --name=c3 -v /volume centos:7 /bin/bash
~~~

2. 创建启动 c1 c2 容器，使用 –-volumes-from 参数 设置数据卷

~~~shell
docker run –it --name=c1 --volumes-from c3 centos:7 /bin/bash

docker run –it --name=c2 --volumes-from c3 centos:7 /bin/bash
~~~

### 3.4 数据卷小结

1. 数据卷概念
   •宿主机的一个目录或文件

2. 数据卷作用
   • 容器数据持久化
   • 客户端和容器数据交换
   • 容器间数据交换

3. 数据卷容器
   • 创建一个容器，挂载一个目录，让其他容器继承自该容器( --volume-from )。 

  • 通过简单方式实现数据卷配置